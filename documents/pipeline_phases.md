# Recursive Yak Shaver: パイプライン・フェーズ詳細
# プロジェクト目的: 段階的なタスク処理フローの解説。
# 更新履歴: 1.0 (2026-02-17)

## パイプライン・フロー
RYS は以下の 6 つのフェーズを順番に実行し、ユーザープロンプトを具体的なアクションへと変換する。

### Phase 1: Translation (翻訳・正規化)
- **役割**: ユーザーの自然言語入力を、後続のフェーズが処理しやすい形式（主に英語または標準的な命令文）に正規化する。
- **入力**: ユーザープロンプト
- **出力**: 正規化されたテキスト

### Phase 2: Dispatch (分解・割り当て)
- **役割**: 入力を「アトミック（最小単位）なタスク」に分解し、各タスクに必要な「スキル」をマッピングする。
- **特徴**: 天気や検索、時間取得などのリクエストを、利用可能なスキル（`shell_exec`, `web_access` 等）へ肯定的にマッピングする。また、エンベディングを用いたキャッシュ検索機能を持ち、類似の命令に対しては過去の結果を再利用する。
- **出力**: Task、元のフレーズ、スキルの組み合わせのリスト。

### Phase 3: Grouping / Planning (グルーピング・計画)
- **役割**: 分解されたタスク間の依存関係を整理し、実行可能な「グループ」や「順序」を決定する。

### Phase 4: Job Processing (処理詳細化)
- **役割**: 各タスクを実行するために必要な具体的なパラメータ（ファイルパス、計算式など）を抽出・決定する。

### Phase 5: Script Generation (コード生成)
- **役割**: 各タスクを実行するための具体的なコード（Python、Shellスクリプトなど）を生成する。
- **出力**: 実行可能なスクリプトファイル群。

### Phase 6: Execution (実行)
- **役割**: 生成されたスクリプトを実際に実行する。
- **安全性**: 自動実行 (`--auto`) モードでない限り、実行前に確認を行う。
